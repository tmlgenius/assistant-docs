(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{471:function(t,s,a){"use strict";a.r(s);var n=a(26),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("å¤šæ•°æ®æºæ—¢åŠ¨æ€æ•°æ®æºï¼Œé¡¹ç›®å¼€å‘é€æ¸æ‰©å¤§ï¼Œå•ä¸ªæ•°æ®æºã€å•ä¸€æ•°æ®æºå·²ç»æ— æ³•æ»¡è¶³éœ€æ±‚é¡¹ç›®çš„æ”¯æ’‘éœ€æ±‚ã€‚")]),t._v(" "),a("p",[t._v("ç”±æ­¤å»¶ä¼¸äº†å¤šæ•°æ®æºçš„æ‰©å±•ï¼Œä¸‹æ–‡æä¾›äº†ä¸¤ç§ä¸åŒæ–¹å‘çš„æ‰©å±•æ’ä»¶ã€‚")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("dynamic-datasource")]),t._v(" å¼€æºæ–‡æ¡£ä»˜è´¹ï¼Œå±äºç»„ç»‡å‚ä¸è€…"),a("code",[t._v("å°é”…ç›–")]),t._v("å‘èµ·çš„é¡¹ç›®")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("mybatis-mate")]),t._v(" ä¼ä¸šçº§ä»˜è´¹æˆæƒï¼Œèµ„æ–™æ–‡æ¡£å…è´¹")])])]),t._v(" "),a("h2",{attrs:{id:"dynamic-datasource"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-datasource"}},[t._v("#")]),t._v(" dynamic-datasource")]),t._v(" "),a("p",[t._v("springboot å¿«é€Ÿé›†æˆå¤šæ•°æ®æºçš„å¯åŠ¨å™¨ "),a("a",{attrs:{href:"https://www.kancloud.cn/tracy5546/dynamic-datasource/2264611",target:"_blank",rel:"noopener noreferrer"}},[t._v("ä½¿ç”¨æ–‡æ¡£"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("æ”¯æŒ "),a("strong",[t._v("æ•°æ®æºåˆ†ç»„")]),t._v(" ï¼Œé€‚ç”¨äºå¤šç§åœºæ™¯ çº¯ç²¹å¤šåº“ è¯»å†™åˆ†ç¦» ä¸€ä¸»å¤šä» æ··åˆæ¨¡å¼ã€‚")]),t._v(" "),a("li",[t._v("æ”¯æŒæ•°æ®åº“æ•æ„Ÿé…ç½®ä¿¡æ¯ "),a("strong",[t._v("åŠ å¯†")]),t._v("  ENC()ã€‚")]),t._v(" "),a("li",[t._v("æ”¯æŒæ¯ä¸ªæ•°æ®åº“ç‹¬ç«‹åˆå§‹åŒ–è¡¨ç»“æ„schemaå’Œæ•°æ®åº“databaseã€‚")]),t._v(" "),a("li",[t._v("æ”¯æŒæ— æ•°æ®æºå¯åŠ¨ï¼Œæ”¯æŒæ‡’åŠ è½½æ•°æ®æºï¼ˆéœ€è¦çš„æ—¶å€™å†åˆ›å»ºè¿æ¥ï¼‰ã€‚")]),t._v(" "),a("li",[t._v("æ”¯æŒ "),a("strong",[t._v("è‡ªå®šä¹‰æ³¨è§£")]),t._v(" ï¼Œéœ€ç»§æ‰¿DS(3.2.0+)ã€‚")]),t._v(" "),a("li",[t._v("æä¾›å¹¶ç®€åŒ–å¯¹Druidï¼ŒHikariCpï¼ŒBeeCp,Dbcp2çš„å¿«é€Ÿé›†æˆã€‚")]),t._v(" "),a("li",[t._v("æä¾›å¯¹Mybatis-Plusï¼ŒQuartzï¼ŒShardingJdbcï¼ŒP6syï¼ŒJndiç­‰ç»„ä»¶çš„é›†æˆæ–¹æ¡ˆã€‚")]),t._v(" "),a("li",[t._v("æä¾› "),a("strong",[t._v("è‡ªå®šä¹‰æ•°æ®æºæ¥æº")]),t._v(" æ–¹æ¡ˆï¼ˆå¦‚å…¨ä»æ•°æ®åº“åŠ è½½ï¼‰ã€‚")]),t._v(" "),a("li",[t._v("æä¾›é¡¹ç›®å¯åŠ¨å "),a("strong",[t._v("åŠ¨æ€å¢åŠ ç§»é™¤æ•°æ®æº")]),t._v(" æ–¹æ¡ˆã€‚")]),t._v(" "),a("li",[t._v("æä¾›Mybatisç¯å¢ƒä¸‹çš„  "),a("strong",[t._v("çº¯è¯»å†™åˆ†ç¦»")]),t._v(" æ–¹æ¡ˆã€‚")]),t._v(" "),a("li",[t._v("æä¾›ä½¿ç”¨ "),a("strong",[t._v("spelåŠ¨æ€å‚æ•°")]),t._v(" è§£ææ•°æ®æºæ–¹æ¡ˆã€‚å†…ç½®spelï¼Œsessionï¼Œheaderï¼Œæ”¯æŒè‡ªå®šä¹‰ã€‚")]),t._v(" "),a("li",[t._v("æ”¯æŒ  "),a("strong",[t._v("å¤šå±‚æ•°æ®æºåµŒå¥—åˆ‡æ¢")]),t._v(" ã€‚ï¼ˆServiceA >>>  ServiceB >>> ServiceCï¼‰ã€‚")]),t._v(" "),a("li",[t._v("æä¾›  **åŸºäºseataçš„åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆã€‚")]),t._v(" "),a("li",[t._v("æä¾›  "),a("strong",[t._v("æœ¬åœ°å¤šæ•°æ®æºäº‹åŠ¡æ–¹æ¡ˆã€‚")])])]),t._v(" "),a("blockquote",[a("p",[t._v("çº¦å®š")])]),t._v(" "),a("ol",[a("li",[t._v("æœ¬æ¡†æ¶åªåš "),a("strong",[t._v("åˆ‡æ¢æ•°æ®æº")]),t._v(" è¿™ä»¶æ ¸å¿ƒçš„äº‹æƒ…ï¼Œå¹¶"),a("strong",[t._v("ä¸é™åˆ¶ä½ çš„å…·ä½“æ“ä½œ")]),t._v("ï¼Œåˆ‡æ¢äº†æ•°æ®æºå¯ä»¥åšä»»ä½•CRUDã€‚")]),t._v(" "),a("li",[t._v("é…ç½®æ–‡ä»¶æ‰€æœ‰ä»¥ä¸‹åˆ’çº¿ "),a("code",[t._v("_")]),t._v(" åˆ†å‰²çš„æ•°æ®æº "),a("strong",[t._v("é¦–éƒ¨")]),t._v(" å³ä¸ºç»„çš„åç§°ï¼Œç›¸åŒç»„åç§°çš„æ•°æ®æºä¼šæ”¾åœ¨ä¸€ä¸ªç»„ä¸‹ã€‚")]),t._v(" "),a("li",[t._v("åˆ‡æ¢æ•°æ®æºå¯ä»¥æ˜¯ç»„åï¼Œä¹Ÿå¯ä»¥æ˜¯å…·ä½“æ•°æ®æºåç§°ã€‚ç»„ååˆ™åˆ‡æ¢æ—¶é‡‡ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•åˆ‡æ¢ã€‚")]),t._v(" "),a("li",[t._v("é»˜è®¤çš„æ•°æ®æºåç§°ä¸º  "),a("strong",[t._v("master")]),t._v(" ï¼Œä½ å¯ä»¥é€šè¿‡ "),a("code",[t._v("spring.datasource.dynamic.primary")]),t._v(" ä¿®æ”¹ã€‚")]),t._v(" "),a("li",[t._v("æ–¹æ³•ä¸Šçš„æ³¨è§£ä¼˜å…ˆäºç±»ä¸Šæ³¨è§£ã€‚")]),t._v(" "),a("li",[t._v("DSæ”¯æŒç»§æ‰¿æŠ½è±¡ç±»ä¸Šçš„DSï¼Œæš‚ä¸æ”¯æŒç»§æ‰¿æ¥å£ä¸Šçš„DSã€‚")])]),t._v(" "),a("blockquote",[a("p",[t._v("ä½¿ç”¨æ–¹æ³•")])]),t._v(" "),a("ol",[a("li",[t._v("å¼•å…¥dynamic-datasource-spring-boot-starterã€‚")])]),t._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.baomidou"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dynamic-datasource-spring-boot-starter"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${version}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("é…ç½®æ•°æ®æºã€‚")])]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dynamic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("primary")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#è®¾ç½®é»˜è®¤çš„æ•°æ®æºæˆ–è€…æ•°æ®æºç»„,é»˜è®¤å€¼å³ä¸ºmaster")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("strict")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ä¸¥æ ¼åŒ¹é…æ•°æ®æº,é»˜è®¤false. trueæœªåŒ¹é…åˆ°æŒ‡å®šæ•°æ®æºæ—¶æŠ›å¼‚å¸¸,falseä½¿ç”¨é»˜è®¤æ•°æ®æº")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("master")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//xx.xx.xx.xx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3306/dynamic\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" root\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver-class-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.mysql.jdbc.Driver "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3.2.0å¼€å§‹æ”¯æŒSPIå¯çœç•¥æ­¤é…ç½®")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave_1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//xx.xx.xx.xx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3307/dynamic\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" root\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver-class-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.mysql.jdbc.Driver\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave_2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ENC(xxxxx) "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å†…ç½®åŠ å¯†,ä½¿ç”¨è¯·æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ENC(xxxxx)\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ENC(xxxxx)\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver-class-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.mysql.jdbc.Driver\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#......çœç•¥")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ä»¥ä¸Šä¼šé…ç½®ä¸€ä¸ªé»˜è®¤åº“masterï¼Œä¸€ä¸ªç»„slaveä¸‹æœ‰ä¸¤ä¸ªå­åº“slave_1,slave_2")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br")])]),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¤šä¸»å¤šä»                      çº¯ç²¹å¤šåº“ï¼ˆè®°å¾—è®¾ç½®primaryï¼‰                   æ··åˆé…ç½®")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                               "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                               "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                           "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                           "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dynamic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                              "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dynamic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                              "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dynamic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                           "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                           "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("master_1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                             "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mysql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("master")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("master_2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                             "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("oracle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                               "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave_1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave_1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                              "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sqlserver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave_2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave_2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                              "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("postgresql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                           "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("oracle_1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave_3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                              "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("h2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                                   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("oracle_2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("ä½¿ç”¨  "),a("strong",[t._v("@DS")]),t._v("  åˆ‡æ¢æ•°æ®æºã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("@DS")]),t._v(" å¯ä»¥æ³¨è§£åœ¨æ–¹æ³•ä¸Šæˆ–ç±»ä¸Šï¼Œ"),a("strong",[t._v("åŒæ—¶å­˜åœ¨å°±è¿‘åŸåˆ™ æ–¹æ³•ä¸Šæ³¨è§£ ä¼˜å…ˆäº ç±»ä¸Šæ³¨è§£")]),t._v("ã€‚")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("æ³¨è§£")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("ç»“æœ")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("æ²¡æœ‰@DS")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("é»˜è®¤æ•°æ®æº")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v('@DS("dsName")')]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("dsNameå¯ä»¥ä¸ºç»„åä¹Ÿå¯ä»¥ä¸ºå…·ä½“æŸä¸ªåº“çš„åç§°")])])])]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@DS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"slave"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceImpl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JdbcTemplate")]),t._v(" jdbcTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("selectAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("  jdbcTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryForList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@DS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"slave_1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("selectByCondition")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("  jdbcTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryForList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from user where age >10"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br")])]),a("h2",{attrs:{id:"mybatis-mate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mybatis-mate"}},[t._v("#")]),t._v(" mybatis-mate")]),t._v(" "),a("p",[t._v("é«˜æ•ˆç®€å•çš„"),a("code",[t._v("Mybatis")]),t._v("åŸç”Ÿæ’ä»¶å¤šæ•°æ®æºæ‰©å±•ç»„ä»¶")]),t._v(" "),a("p",[t._v("ğŸ‘‰ "),a("a",{attrs:{href:"https://gitee.com/baomidou/mybatis-mate-examples/tree/master/mybatis-mate-sharding",target:"_blank",rel:"noopener noreferrer"}},[t._v("mybatis-mate-sharding"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("æ³¨è§£ @Sharding")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("å±æ€§")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("ç±»å‹")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("å¿…é¡»æŒ‡å®š")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("é»˜è®¤å€¼")]),t._v(" "),a("th",[t._v("æè¿°")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("value")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("String")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("æ˜¯")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v('""')]),t._v(" "),a("td",[t._v("åˆ†åº“ç»„åï¼Œç©ºä½¿ç”¨é»˜è®¤ä¸»æ•°æ®æº")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("strategy")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Class")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("å¦")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("RandomShardingStrategy")]),t._v(" "),a("td",[t._v("åˆ†åº“&åˆ†è¡¨ç­–ç•¥")])])])]),t._v(" "),a("ul",[a("li",[t._v("é…ç½®")])]),t._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v("mybatis-mate:\n  sharding:\n    health: true # å¥åº·æ£€æµ‹\n    primary: mysql # é»˜è®¤é€‰æ‹©æ•°æ®æº\n    datasource:\n      mysql: # æ•°æ®åº“ç»„\n        - key: node1\n          ...\n        - key: node2\n          cluster: slave # ä»åº“è¯»å†™åˆ†ç¦»æ—¶å€™è´Ÿè´£ sql æŸ¥è¯¢æ“ä½œï¼Œä¸»åº“ master é»˜è®¤å¯ä»¥ä¸å†™\n          ...\n      postgres:\n        - key: node1 # æ•°æ®èŠ‚ç‚¹\n          ...\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("ul",[a("li",[t._v("æ³¨è§£ "),a("code",[t._v("Sharding")]),t._v(" åˆ‡æ¢æ•°æ®æºï¼Œç»„å†…èŠ‚ç‚¹é»˜è®¤éšæœºé€‰æ‹©ï¼ˆæŸ¥ä»å†™ä¸»ï¼‰")])]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Mapper")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Sharding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserMapper")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseMapper")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Sharding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postgres"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("selectByUsername")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("ul",[a("li",[t._v("åˆ‡æ¢æŒ‡å®šæ•°æ®åº“èŠ‚ç‚¹")])]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ‡æ¢åˆ° mysql ä»åº“ node2 èŠ‚ç‚¹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ShardingKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("change")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysqlnode2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[t._v("å¤šæ•°æ®æºåŠ¨æ€åŠ è½½å¸è½½")])]),t._v(" "),a("p",[t._v("ğŸ‘‰ "),a("a",{attrs:{href:"https://gitee.com/baomidou/mybatis-mate-examples/tree/master/mybatis-mate-sharding-dynamic",target:"_blank",rel:"noopener noreferrer"}},[t._v("mybatis-mate-sharding-dynamic"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("å¤šæ•°æ®æºäº‹åŠ¡ï¼ˆ jta atomikosï¼‰")])]),t._v(" "),a("p",[t._v("ğŸ‘‰ "),a("a",{attrs:{href:"https://gitee.com/baomidou/mybatis-mate-examples/tree/master/mybatis-mate-sharding-jta-atomikos",target:"_blank",rel:"noopener noreferrer"}},[t._v("mybatis-mate-sharding-jta-atomikos"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);